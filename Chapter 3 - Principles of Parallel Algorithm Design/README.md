# 三、并行算法设计原则

算法开发是利用计算机解决问题的重要组成部分。顺序算法本质上是使用串行计算机解决给定问题的口诀或一系列基本步骤。同样，并行算法是告诉我们如何使用多个处理器解决给定问题的秘诀。然而，指定并行算法所涉及的不仅仅是指定步骤。至少，并行算法增加了并发性的维度，算法设计者必须指定可同时执行的步骤集。这对于从并行计算机的使用中获得任何性能优势都是至关重要的。在实践中，指定一个非简单的并行算法可能包括以下部分或全部内容：

- 确定可以同时执行的工作部分
- 将并发工作映射到并行运行的多个进程中
- 分发与程序相关的输入、输出和中间数据
- 管理对多个处理器共享数据的访问
- 在并行程序执行的各个阶段同步处理器

通常情况下，上述每个步骤都有几种选择，但通常情况下，相对较少的选择组合就能产生与解 决问题所使用的计算和存储资源相称的并行算法性能。通常，在不同的并行架构或不同的并行编程模式下，不同的选择会产生最佳性能。

在本章中，我们将有条不紊地讨论设计和实现并行算法的过程。我们将假定，对并行算法或程序进行完整描述的责任在于程序员或算法设计者。就目前的技术水平而言，自动并行化的工具和编译器似乎只适用于高度结构化的程序或程序的一部分。因此，我们在本章或本书其他章节中不考虑这些工具和编译器。

## [3.1 预备知识](./3.1%20Preliminaries.md)

将计算划分成许多小的计算，再把它们分配到不同处理器中以便井行执行，这是并行算法设计中的两个关键步骤。在给出一些基本术语定义之后，将通过使用矩阵向量相乘和数据库查询处理这两个实例，来介绍井行算法设计的这两个关键步骤。

- **3.1.1 分解、任务与依赖图**
- **3.1.2 粒度、并发性与任务交互**
- **3.1.3 进程和映射**
- **3.1.4 进程与处理器**

## [3.2 分解技术](./3.2%20Decomposition%20Techniques.md)

并行求解问题的基本步霎就是将被执行的计算划分成一组按照任务依赖图并行执行的任务。本节将讨论一些为获得并发性而经常使用的分解技术，但并不列举所有可能的分解技术。而且，对某个给定的问题，某种分解技术并不总能得到它的最好并行算法。虽然有这些缺陷，但本节讨论的分解技术通常是解决许多问曜的很好的切入点，将这些技术加以组合，能得到对许多问髦的有效分解。

- **3.2.1 递归分解**
- **3.2.2 数据分解**
- **3.2.3 探索分解**
- **3.2.4 推测分解**
- **3.2.5 混合分解**

## [3.3 任务与交互的特性](./3.3%20Characteristics%20of%20Tasks%20and%20Interactions.md)

前一节讲述的各种分解技术，使我们能确定某个问题可获得的并发性，并把问题分解为可并行执行的多个任务。 设计并行算法过程中的下一步就是取出这些任务，并把它们分配（即映射）给可用的处理器。当设计映射方案来构造好的并行算法时，常常能从分解中得到提示。任务的性质和任务之间的交互对映射有影响。本节将讨论对选择好的映射方案有影响的各种任务特性及任务间的交互特性。

- **3.3.1 任务特性**
- **3.3.2 任务间交互的特性**

## [3.4 负载平衡的映射技术](./3.4%20Mapping%20Techniques%20for%20Load Balancing.md)

一旦计算被分解成任务，这些任务就会被映射到进程中，目标是在最短的时间内完成所有任务。为了缩短执行时间，必须尽量减少并行执行任务的开销。对于给定的分解，有两个关键的开销来源。进程间交互花费的时间是开销的一个来源。另一个重要的开销来源是某些进程闲置的时间。由于各种原因，一些进程甚至可能在整体计算完成前就处于闲置状态。负载分布不均可能导致某些进程比其他进程更早完成。有时，映射到某个进程上的所有未完成任务可能都在等待映射到其他进程上的任务完成，以满足任务依赖图施加的限制。交互和空闲通常都是映射的函数。因此，一个好的流程任务映射必须努力实现以下两个目标：(1) 减少流程之间的交互时间；(2) 减少某些流程在执行某些任务时的闲置时间。

- **3.4.1 静态映射方案**
- **3.4.2 动态映射方案**

## [3.5 控制交互开销的方法](./3.5%20Methods%20for%20Containing%20Interaction%20Overheads.md)

如前所述，减少并发任务间的交互开销对高效并行程序非常重要。并行程序因进程间交互而产生的开销取决于很多因素，如交互过程中交换的数据量、交互频率、交互的空间和时间模式等。

在本节中，我们将讨论一些可用于减少并行程序交互开销的通用技术。这些技术操纵上述三个因素中的一个或多个，以减少交互开销。其中一些技术适用于为算法设计分解和映射方案，另一些则适用于在特定范式下对算法进行编程。并非所有技术都适用于所有并行编程范式，其中一些技术可能需要底层硬件的支持。

- **3.5.1 最大化数据本地性**
- **3.5.2 最小化争用与热点**
- **3.5.3 使计算与交互重叠**
- **3.5.4 复制数据或计算**
- **3.5.5 使用最优聚合交互操作**
- **3.5.6 一些交互与另一些交互的重叠**

## [3.6 并行算法模型](./3.6%20Parallel%20Algorithm%20Models.md)

在讨论了分解、映射和最小化交互开销的技术之后，我们现在介绍一些常用的并行算法模型。算法模型通常是通过选择分解和映射技术以及应用适当的策略来最小化交互的一种并行算法结构化方法。

- **3.6.1 数据并行模型**
- **3.6.2 任务图模型**
- **3.6.3 工作池模型**
- **3.6.4 主-从模型**
- **3.6.5 流水线模型或生产者-消费者模型**
- **3.6.6 混合模型**